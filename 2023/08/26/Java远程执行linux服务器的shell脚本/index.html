<!DOCTYPE html>
<html lang="zh-CN">
<head prefix="og: https://ogp.me/ns#">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="color-scheme" content="light dark">
    
      <title>
        
          Javaè¿œç¨‹æ‰§è¡ŒlinuxæœåŠ¡å™¨çš„shellè„šæœ¬ - 
              iCheng
      </title>
      
        <link rel="shortcut icon" href="/theme-img/logo.png">
          
            
              <link rel='manifest' href='/manifest.json'>
              

                
                  
                    
                      <meta property="og:title" content="Javaè¿œç¨‹æ‰§è¡ŒlinuxæœåŠ¡å™¨çš„shellè„šæœ¬ - iCheng" />
                      
                      <meta property="og:type" content="article" />
                      
                      <meta property="og:url" content="http://example.com/2023/08/26/Java%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8Clinux%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84shell%E8%84%9A%E6%9C%AC/index.html" />
                      
                      <meta property="og:image" content="/favicon.png" />
                      
                      <meta property="og:article:published_time" content="2023-08-26T01:19:42.000Z" />
                      
                      <meta property="og:article:author" content="Duan WeiCheng" />
                      
                        

                          
<link rel="stylesheet" href="/css/var.css">

                            
<link rel="stylesheet" href="/css/main.css">

                              
<link rel="stylesheet" href="/css/typography.css">

                                
<link rel="stylesheet" href="/css/code-highlighting.css">

                                  
<link rel="stylesheet" href="/css/components.css">

                                    
<link rel="stylesheet" href="/css/nav.css">

                                      
<link rel="stylesheet" href="/css/paginator.css">

                                        
<link rel="stylesheet" href="/css/footer.css">

                                          
<link rel="stylesheet" href="/css/post-list.css">

                                            
                                              
<link rel="stylesheet" href="/css/rainbow-banner.css">

                                                
                                                  
                                                    
<link rel="stylesheet" href="/css/toc.css">

                                                      
                                                        
                                                          
<link rel="stylesheet" href="/css/giscus.css">

                                                            
                                                              
                                                                    
                                                                      
<link rel="stylesheet" href="/css/post.css">

                                                                        
                                                                          
                                                                                
                                                                                      
                                                                                            

                                                                                                  
                                                                                                      <meta name="generator" content="Hexo 6.3.0"></head>

  <body data-color-scheme="light" data-uppercase-categories="true" 
    data-rainbow-banner="true"
      data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
          data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
            
              data-config-root="/"
                
                  data-toc="true"
                    data-toc-max-depth="2"
                      
                        
                              >
                              <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">iCheng</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/categories">Categories</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/iCheng" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
                                
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/Java/">Java</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>August</span>
            <span>26,</span>
            <span>2023</span>
        </div>
        

        <h2 class="title">Javaè¿œç¨‹æ‰§è¡ŒlinuxæœåŠ¡å™¨çš„shellè„šæœ¬</h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <p><strong>ä¹‹å‰æœ‰ä¸€ä¸ªä¸šåŠ¡éœ€æ±‚ï¼š</strong></p>
<p>æœ‰ä¸€ä¸ª Flink ä»»åŠ¡ä»£ç æ˜¯åŠ¨æ€ç”Ÿæˆçš„ï¼Œæ–°ä»»åŠ¡ç”Ÿæˆåï¼Œæäº¤åˆ°ç›®æ ‡æœåŠ¡å™¨é›†ç¾¤ï¼Œå¯åŠ¨æ–°ä»»åŠ¡ï¼Œè¯»å–å¯¹åº”æ•°æ®æµ</p>
<p>æ‰€ä»¥è¦èƒ½å¤Ÿå°†è¿™ä¸ªåŠ¨æ€æ–‡ä»¶æ‰“ä¸º jar åŒ…ï¼Œä¼ è¾“åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œå¹¶æäº¤ jar åŒ…åˆ°é›†ç¾¤</p>
<p><strong>æ•´ä½“æµç¨‹ï¼š</strong></p>
<p>å†™ 3 ä¸ªè„šæœ¬:</p>
<ul>
<li>batè„šæœ¬ï¼šä½äºæœ¬åœ° SpringBoot é¡¹ç›®ä¸­ï¼Œåªéœ€æ‰§è¡Œæ‰“ jar åŒ…çš„å‘½ä»¤</li>
<li>batè„šæœ¬ï¼šä½äºæœ¬åœ° SpringBoot é¡¹ç›®ä¸­ï¼Œå°† jar åŒ…ä¼ è¾“åˆ°ç›®æ ‡æœåŠ¡å™¨</li>
<li>shellè„šæœ¬ï¼šä½äºç›®æ ‡æœåŠ¡å™¨ä¸Šï¼Œæäº¤ jar åŒ…ä»»åŠ¡</li>
</ul>
<p>ç¬¬ä¸€ä¸ªè„šæœ¬ Java å¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œåé¢ä¸¤ä¸ªè„šæœ¬ï¼Œéœ€è¦å’Œè¿œç¨‹æœåŠ¡å™¨å»ºç«‹sshé“¾æ¥ï¼Œå†è°ƒç”¨æŒ‡å®šçš„è„šæœ¬</p>
<h1 id="1-è„šæœ¬æ–‡ä»¶"><a href="#1-è„šæœ¬æ–‡ä»¶" class="headerlink" title="1 è„šæœ¬æ–‡ä»¶"></a>1 è„šæœ¬æ–‡ä»¶</h1><h2 id="1-1-æ‰“-jar-åŒ…"><a href="#1-1-æ‰“-jar-åŒ…" class="headerlink" title="1.1 æ‰“ jar åŒ…"></a>1.1 æ‰“ jar åŒ…</h2><p>å‘½åä¸º .bat æ–‡ä»¶ï¼Œæ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹</p>
<p>æ‰§è¡Œæ—¶ä¼šè¿›è¡Œæ‰“åŒ…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line"></span><br><span class="line">echo ==========================start to install all modules===============================</span><br><span class="line"></span><br><span class="line">if not exist &quot;%M2_HOME%\bin\mvn.cmd&quot; echo Please set the M2_HOME variable in your environment,We need maven! &amp; EXIT /B 2</span><br><span class="line"></span><br><span class="line">set SERVER=common-starter eureka-server config-server device-demo message-system report-system udp-server</span><br><span class="line"></span><br><span class="line">cd %~dp0</span><br><span class="line"></span><br><span class="line">do (</span><br><span class="line">    call mvn clean package</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">timeout /T 3 /NOBREAK</span><br><span class="line"></span><br><span class="line">exit</span><br></pre></td></tr></table></figure>

<h2 id="1-2-jar-åŒ…ä¼ è¾“"><a href="#1-2-jar-åŒ…ä¼ è¾“" class="headerlink" title="1.2 jar åŒ…ä¼ è¾“"></a>1.2 jar åŒ…ä¼ è¾“</h2><blockquote>
<p>éœ€è¦å°†æ‰“å¥½çš„jaråŒ… ä»æœ¬åœ°ä¸Šä¼ è‡³ linux æœåŠ¡å™¨çš„ç›®æ ‡ç›®å½•ä¸‹</p>
</blockquote>
<p>åœ¨æ­¤ä¹‹å‰éœ€é…ç½®sshæ— å¯†ç ç™»å½•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">æ‰“å¼€ windows powershell:</span><br><span class="line">æ‰§è¡Œç”Ÿæˆå¯†é’¥ssh-keygençš„å‘½ä»¤ï¼š</span><br><span class="line">ssh-keygen -t rsa</span><br><span class="line">é‡åˆ°è¾“å…¥ä¸€è·¯å›è½¦ï¼Œè¿”å›ç”Ÿæˆç§˜é’¥çš„ä½ç½®ï¼šå›è½¦å›è½¦å›è½¦</span><br><span class="line">ä¸Šä¼ ç§˜é’¥åˆ°è¿œç«¯æœåŠ¡å™¨ï¼š</span><br><span class="line">cat ~/.ssh/id_*.pub | ssh  root@hadoop102 &#x27;cat &gt;&gt; .ssh/authorized_keys&#x27;</span><br></pre></td></tr></table></figure>

<p>åˆ›å»º  .bat æ–‡ä»¶ï¼Œæ‰§è¡Œè¯¥è„šæœ¬ä¼šå°†å¯¹åº”æ–‡ä»¶ç§»åŠ¨åˆ°å¯¹åº”åœ°å€</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo è¿æ¥è¿œç¨‹æœåŠ¡å™¨</span><br><span class="line">scp -r jaråŒ…åœ°å€  root@hadoop102:/opt/XXX/XXXï¼ˆç›®æ ‡åœ°å€ç›®å½•ï¼‰</span><br><span class="line">exit</span><br></pre></td></tr></table></figure>

<h2 id="1-3-æäº¤ä»»åŠ¡åˆ°é›†ç¾¤"><a href="#1-3-æäº¤ä»»åŠ¡åˆ°é›†ç¾¤" class="headerlink" title="1.3 æäº¤ä»»åŠ¡åˆ°é›†ç¾¤"></a>1.3 æäº¤ä»»åŠ¡åˆ°é›†ç¾¤</h2><p>å½“å‰ jar åŒ…å­˜åœ¨æœåŠ¡å™¨ç›®å½•ä¸‹ï¼Œåœ¨ç¡®è®¤å¯åŠ¨äº†é›†ç¾¤å</p>
<p>åˆ›å»º shell è„šæœ¬ï¼Œæ‰§è¡Œè¯¥è„šæœ¬ä¼šå°† jar åŒ…ä»»åŠ¡æäº¤åˆ° Flink é›†ç¾¤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">case $1 in</span><br><span class="line"> &quot;start&quot;)&#123;</span><br><span class="line"> for i in hadoop102</span><br><span class="line"> do</span><br><span class="line">  echo &quot;========== $i ==========&quot;</span><br><span class="line">  ssh $i &quot;/opt/Environment_DataLake/flink-1.13.3/bin/flink run -m hadoop102:8081 -c com.dwc.test.motor /opt/Environment_DataLake/flink-1.13.3/job/DataToLake-1.0-SNAPSHOT.jar&quot;</span><br><span class="line"> done</span><br><span class="line">&#125;;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>

<h1 id="2-Javaè°ƒç”¨è„šæœ¬"><a href="#2-Javaè°ƒç”¨è„šæœ¬" class="headerlink" title="2 Javaè°ƒç”¨è„šæœ¬"></a>2 Javaè°ƒç”¨è„šæœ¬</h1><h2 id="2-1-è°ƒç”¨æœ¬åœ°çš„è„šæœ¬"><a href="#2-1-è°ƒç”¨æœ¬åœ°çš„è„šæœ¬" class="headerlink" title="2.1 è°ƒç”¨æœ¬åœ°çš„è„šæœ¬"></a>2.1 è°ƒç”¨æœ¬åœ°çš„è„šæœ¬</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> dwc</span></span><br><span class="line"><span class="comment"> * .batè„šæœ¬å¯åŠ¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">startbat</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">batPath</span> <span class="operator">=</span> <span class="string">&quot;XXX.bat&quot;</span>; <span class="comment">// ç¬¬ä¸€ä¸ªbatè„šæœ¬è·¯å¾„</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">batPath2</span> <span class="operator">=</span><span class="string">&quot;XXXX.bat&quot;</span>;  <span class="comment">// ç¬¬äºŒä¸ªbatè„šæœ¬è·¯å¾„</span></span><br><span class="line">        <span class="type">File</span> <span class="variable">batFile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(batPath);</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">batFileExist</span> <span class="operator">=</span> batFile.exists();</span><br><span class="line">        System.out.println(<span class="string">&quot;batFileExist:&quot;</span> + batFileExist);</span><br><span class="line">        <span class="keyword">if</span> (batFileExist) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜Šæ­£åœ¨æ‰§è¡Œç¼–è¯‘ğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜Š&quot;</span>);</span><br><span class="line">            callCmd(batPath);</span><br><span class="line">            System.out.println(<span class="string">&quot;ğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜Šæ­£åœ¨ä¸Šä¼ è‡³linuxç³»ç»ŸğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜Š&quot;</span>);</span><br><span class="line">            callCmd(batPath2);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;ğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜Šbatè„šæœ¬è¿è¡Œå®ŒæˆğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜Š&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span>  <span class="title function_">callCmd</span><span class="params">(String locationCmd)</span>&#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Process</span> <span class="variable">child</span> <span class="operator">=</span> Runtime.getRuntime().exec(locationCmd);</span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> child.getInputStream();</span><br><span class="line">            BufferedReader bufferedReader=<span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(in));</span><br><span class="line">            String line;</span><br><span class="line">            <span class="keyword">while</span>((line=bufferedReader.readLine())!=<span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                sb.append(line + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            in.close();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                child.waitFor();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                System.out.println(e);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;sb:&quot;</span> + sb.toString());</span><br><span class="line">            System.out.println(<span class="string">&quot;callCmd execute finished&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-2-è°ƒç”¨è¿œç¨‹linuxè„šæœ¬"><a href="#2-2-è°ƒç”¨è¿œç¨‹linuxè„šæœ¬" class="headerlink" title="2.2 è°ƒç”¨è¿œç¨‹linuxè„šæœ¬"></a>2.2 è°ƒç”¨è¿œç¨‹linuxè„šæœ¬</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ch.ethz.ssh2.Connection;</span><br><span class="line"><span class="keyword">import</span> ch.ethz.ssh2.Session;</span><br><span class="line"><span class="keyword">import</span> ch.ethz.ssh2.StreamGobbler;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.calcite.shaded.org.apache.commons.io.IOUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> dwc</span></span><br><span class="line"><span class="comment"> * è¿œç¨‹æ‰§è¡Œlinuxçš„shell script</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RemoteExecuteCommand</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">linuxIP</span> <span class="operator">=</span> <span class="string">&quot;ipåœ°å€&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">usrName</span> <span class="operator">=</span> <span class="string">&quot;ç”¨æˆ·å&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">passwd</span>  <span class="operator">=</span> <span class="string">&quot;å¯†ç &quot;</span>;</span><br><span class="line">        <span class="type">RemoteExecuteCommand</span> <span class="variable">rec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RemoteExecuteCommand</span>(linuxIP, usrName, passwd);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;ğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜Šæ­£åœ¨ä¸Šä¼ ä»»åŠ¡è‡³é›†ç¾¤ğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜Š&quot;</span>);</span><br><span class="line">        <span class="comment">// æ‰§è¡Œè„šæœ¬</span></span><br><span class="line">        System.out.println(rec.execute(<span class="string">&quot;XXX.shell&quot;</span>));  <span class="comment">//shellè„šæœ¬åœ°å€</span></span><br><span class="line">        <span class="comment">// æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">        System.out.println(rec.execute(<span class="string">&quot;jps&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;ğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜Šjobä¸Šä¼ å®ŒæˆğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜ŠğŸ˜Š&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å­—ç¬¦ç¼–ç é»˜è®¤æ˜¯utf-8</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">DEFAULTCHART</span> <span class="operator">=</span> <span class="string">&quot;UTF-8&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> Connection conn;</span><br><span class="line">    <span class="keyword">private</span> String ip;</span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="keyword">private</span> String userPwd;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RemoteExecuteCommand</span><span class="params">(String ip, String userName, String userPwd)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.ip = ip;</span><br><span class="line">        <span class="built_in">this</span>.userName = userName;</span><br><span class="line">        <span class="built_in">this</span>.userPwd = userPwd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿œç¨‹ç™»å½•linuxä¸»æœº</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> V0.1</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ç™»å½•æˆåŠŸè¿”å›trueï¼Œå¦åˆ™è¿”å›false</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">login</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flg</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = <span class="keyword">new</span> <span class="title class_">Connection</span>(ip);</span><br><span class="line">            <span class="comment">// è¿æ¥</span></span><br><span class="line">            conn.connect();</span><br><span class="line">            <span class="comment">// è®¤è¯</span></span><br><span class="line">            flg = conn.authenticateWithPassword(userName, userPwd);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(<span class="string">&quot;è¿œç¨‹è¿æ¥æœåŠ¡å™¨å¤±è´¥&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flg;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿œç¨‹æ‰§è¡Œshllè„šæœ¬æˆ–è€…å‘½ä»¤</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> cmd å³å°†æ‰§è¡Œçš„å‘½ä»¤</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å‘½ä»¤æ‰§è¡Œå®Œåè¿”å›çš„ç»“æœå€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> V0.1</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">execute</span><span class="params">(String cmd)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">Session</span> <span class="variable">session</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (login()) &#123;</span><br><span class="line">                <span class="comment">// æ‰“å¼€ä¸€ä¸ªä¼šè¯</span></span><br><span class="line">                session = conn.openSession();</span><br><span class="line">                <span class="comment">// æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">                session.execCommand(cmd);</span><br><span class="line">                result = processStdout(session.getStdout(), DEFAULTCHART);</span><br><span class="line">                <span class="comment">// å¦‚æœä¸ºè¾“å‡ºä¸ºç©ºï¼Œè¯´æ˜è„šæœ¬æ‰§è¡Œå‡ºé”™äº†</span></span><br><span class="line">                <span class="keyword">if</span> (StringUtils.isBlank(result)) &#123;</span><br><span class="line">                    result = processStdout(session.getStderr(), DEFAULTCHART);</span><br><span class="line">                &#125;</span><br><span class="line">                conn.close();</span><br><span class="line">                session.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(<span class="string">&quot;å‘½ä»¤æ‰§è¡Œå¤±è´¥&quot;</span>, e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (conn != <span class="literal">null</span>) &#123;</span><br><span class="line">                conn.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (session != <span class="literal">null</span>) &#123;</span><br><span class="line">                session.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è§£æè„šæœ¬æ‰§è¡Œè¿”å›çš„ç»“æœé›†</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> in è¾“å…¥æµå¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> charset ç¼–ç </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> V0.1</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ä»¥çº¯æ–‡æœ¬çš„æ ¼å¼è¿”å›</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">processStdout</span><span class="params">(InputStream in, String charset)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">stdout</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StreamGobbler</span>(in);</span><br><span class="line">        <span class="type">StringBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">        <span class="type">InputStreamReader</span> <span class="variable">isr</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            isr = <span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(stdout, charset);</span><br><span class="line">            br = <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(isr);</span><br><span class="line">            <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">while</span> ((line = br.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">                buffer.append(line + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(<span class="string">&quot;ä¸æ”¯æŒçš„ç¼–ç å­—ç¬¦é›†å¼‚å¸¸&quot;</span>, e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(<span class="string">&quot;è¯»å–å¤±è´¥&quot;</span>, e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            IOUtils.close(br);</span><br><span class="line">            IOUtils.close(isr);</span><br><span class="line">            IOUtils.close(stdout);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> buffer.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by Duan WeiCheng, licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a>.</p>
        </div>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2023/09/09/%E8%99%9A%E6%8B%9FDOM%E7%9A%84%E6%80%A7%E8%83%BD%E5%88%B0%E5%BA%95%E5%A6%82%E4%BD%95/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">è™šæ‹Ÿ DOM çš„æ€§èƒ½åˆ°åº•å¦‚ä½•</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2023/08/10/Vue%E8%BD%ACReact%E6%8C%87%E5%8D%97/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">Vue è½¬ React æŒ‡å—</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
        <script src="https://giscus.app/client.js" data-repo="iCheng/iCheng.github.io" data-repo-id="R_kgDOJ4MJ0g" data-category="General" data-category-id="DIC_kwDOJ4MJ0s4CXwBh" data-mapping="title" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous" async> </script>
        
    
</article>

                                  <footer>
  <div class="inner">
    <div class="links">
      
        <div class="group">
          <h2 class="title">
            Blog
          </h2>
          
            <a href="/" class="item">
              Blog
            </a>
            
            <a href="/archives" class="item">
              Archives
            </a>
            
            <a href="/tags" class="item">
              Tags
            </a>
            
            <a href="/categories" class="item">
              Categories
            </a>
            
            <a href="/search" class="item">
              Search
            </a>
            
            <a href="/friends" class="item">
              Friends
            </a>
            
            <a href="/about" class="item">
              About
            </a>
            
        </div>
        
        <div class="group">
          <h2 class="title">
            Projects
          </h2>
          
        </div>
        
        <div class="group">
          <h2 class="title">
            Me
          </h2>
          
            <a target="_blank" rel="noopener" href="https://github.com/iCheng" class="item">
              GitHub
            </a>
            
            <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_52268321?spm=1000.2115.3001.5343" class="item">
              CSDN
            </a>
            
        </div>
        
    </div>
    <span>&copy; 2024
        Duan WeiCheng
          <!-- Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> -->
    </span>
    
        
          <br>
          <div style="margin-top: 15px; color: #06c;">
            <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <span id="busuanzi_container_site_pv">è®¿é—®é‡ <span id="busuanzi_value_site_pv"></span> æ¬¡</span>
          </div>
          <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
            <label>
              <input type="radio" value="light">
              <span>Light</span>
            </label>
            <label>
              <input type="radio" value="dark">
              <span>Dark</span>
            </label>
            <label>
              <input type="radio" value="auto">
              <span>Auto</span>
            </label>
          </div>
          
  </div>
</footer>

                                    
<script src="/js/main.js"></script>

                                      
                                            
                                                  

                                                        
                                                          <script src="https://unpkg.com/scrollreveal"></script>
                                                          <script>
                                                            window.addEventListener('load', () => {
                                                              ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                                                              ScrollReveal().reveal('.post-list-item .cover-img img')
                                                              ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
                                                            })
                                                          </script>
                                                          
                                                            <!-- æ‰©å±•è¯­æ³• -->
                                                            <script defer
                                                              src="/js/hexo_relayout_image.js"></script>
  </body>

</html>